sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/routing/History","sap/ui/core/UIComponent","sap/m/MessageBox","sap/ui/model/json/JSONModel"],function(e,t,a,s,r){"use strict";return e.extend("leave.management.controller.CreateLeaveRequest",{onInit:function(){this._oRouter=a.getRouterFor(this);this._oRouter.attachRouteMatched(this.onRouteMatched,this);const e=sap.ui.getCore().getMessageManager();const t=e.getMessageModel();t.bindList("/").attachChange(function(e){const t=e.getSource().getContexts().map(e=>e.getObject());const a=t.find(e=>e.type==="Error");if(a){s.error(a.message)}});e.registerObject(this.getView(),true)},onRouteMatched:function(e){var t=e.getParameter("name");if(t==="createLeaveRequest"){this._initializeForm()}},_initializeForm:function(){this.byId("leaveTypeSelect").setSelectedKey("");this.byId("startDatePicker").setValue("");this.byId("endDatePicker").setValue("");this.byId("reasonTextArea").setValue("")},onDateChange:function(e){var t=this.byId("startDatePicker").getDateValue();var a=this.byId("endDatePicker").getDateValue();if(t&&a&&t>a){s.warning("End date cannot be before start date");e.getSource().setValueState("Error")}else{e.getSource().setValueState("None")}},_formatDate:function(e){if(!e)return null;const t=e.getFullYear();const a=String(e.getMonth()+1).padStart(2,"0");const s=String(e.getDate()).padStart(2,"0");return`${t}-${a}-${s}`},onSubmit:async function(){if(!this._validateForm())return;try{const e=this.getView().getModel();const t=this._formatDate(this.byId("startDatePicker").getDateValue());const a=this._formatDate(this.byId("endDatePicker").getDateValue());const r=e.bindList("/LeaveRequests");const i={startDate:t,endDate:a,type_code:this.byId("leaveTypeSelect").getSelectedKey(),reason:this.byId("reasonTextArea").getValue()};sap.ui.getCore().getMessageManager().removeAllMessages();const o=r.create(i);await o.created();e.refresh();s.success("Leave request created successfully",{onClose:()=>{this.onNavBack();e.refresh()}})}catch(e){s.error(e.message)}},_validateForm:function(){var e=true;var t=this.getView();if(!this.byId("leaveTypeSelect").getSelectedKey()){this.byId("leaveTypeSelect").setValueState("Error");e=false}else{this.byId("leaveTypeSelect").setValueState("None")}var a=this.byId("startDatePicker").getDateValue();var s=this.byId("endDatePicker").getDateValue();if(!a){this.byId("startDatePicker").setValueState("Error");e=false}else{this.byId("startDatePicker").setValueState("None")}if(!s){this.byId("endDatePicker").setValueState("Error");e=false}else{this.byId("endDatePicker").setValueState("None")}if(a&&s&&a>s){this.byId("endDatePicker").setValueState("Error");e=false}if(!this.byId("reasonTextArea").getValue()){this.byId("reasonTextArea").setValueState("Error");e=false}else{this.byId("reasonTextArea").setValueState("None")}return e},onNavBack:function(){var e=a.getRouterFor(this);if(e){e.navTo("home",{},true)}else{window.location.href="/"}}})});
//# sourceMappingURL=CreateLeaveRequest.controller.js.map