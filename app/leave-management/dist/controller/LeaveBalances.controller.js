sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/routing/History","sap/ui/core/UIComponent","sap/m/MessageBox","sap/ui/model/json/JSONModel"],function(e,t,a,r,o){"use strict";return e.extend("leave.management.controller.LeaveBalances",{onInit:function(){this._oRouter=a.getRouterFor(this);this._oRouter.attachRouteMatched(this.onRouteMatched,this);this.getView().setModel(new o({busy:false,delay:0}),"viewModel")},formatDate:function(e){if(!e)return"";var t=new Date(e);if(isNaN(t))return"";var a=t.getDate().toString().padStart(2,"0");var r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var o=r[t.getMonth()];var n=t.getFullYear();return`${a}-${o}-${n}`},onRouteMatched:function(e){var t=e.getParameter("name");if(t==="leaveBalances"){this._loadLeaveBalances()}},_loadLeaveBalances:async function(){try{const e=this.getView().getModel("viewModel");e.setProperty("/busy",true);const t=this.byId("leaveBalancesTable");const a=t.getBinding("items");if(a){a.attachEventOnce("dataReceived",()=>{e.setProperty("/busy",false)});await a.refresh()}}catch(e){r.error("Error loading leave balances: "+e.message);this.getView().getModel("viewModel").setProperty("/busy",false)}},formatStatusState:function(e){switch(e){case"Approved":return"Success";case"Rejected":return"Error";case"Pending":return"Warning";default:return"None"}},onApproveRequest:function(e){var t=e.getSource().getBindingContext();var a=t.getObject();this._callAction(a.ID,"approveRequest","Leave request approved successfully")},onRejectRequest:function(e){var t=e.getSource().getBindingContext();var a=t.getObject();this._callAction(a.ID,"rejectRequest","Leave request rejected successfully")},_callAction:function(e,t,a){var o=this.getView().getModel();var n="/LeaveRequests("+e+")/"+t;o.callFunction(n,{method:"POST",success:function(){r.success(a);this._loadLeaveRequests()}.bind(this),error:function(e){r.error("Error: "+e.message)}})},onCreateLeaveRequest:function(){this._oRouter.navTo("createLeaveRequest")},onNavBack:function(){var e=a.getRouterFor(this);if(e){e.navTo("home",{},true)}else{window.location.href="/"}}})});
//# sourceMappingURL=LeaveBalances.controller.js.map